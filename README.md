–í–æ—Ç –æ–±–Ω–æ–≤–ª—ë–Ω–Ω—ã–π README —Å –¥–æ–±–∞–≤–ª–µ–Ω–Ω—ã–º —Ä–∞–∑–¥–µ–ª–æ–º **–°—Ç–µ–∫ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π**:

---

# CrazyPoizon Telegram Bot

–ë–æ—Ç –¥–ª—è –ø–æ–º–æ—â–∏ –≤ —Ä–∞—Å—á—ë—Ç–µ —Ü–µ–Ω –∏ –∑–∞–∫–∞–∑–∞ —Ç–æ–≤–∞—Ä–æ–≤ —Å –∫–∏—Ç–∞–π—Å–∫–æ–≥–æ –º–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å–∞ **POIZON**.  
–ü–æ–∑–≤–æ–ª—è–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º —Ä–∞—Å—Å—á–∏—Ç–∞—Ç—å —Å—Ç–æ–∏–º–æ—Å—Ç—å —Ç–æ–≤–∞—Ä–∞ (–≤–∫–ª—é—á–∞—è –¥–æ—Å—Ç–∞–≤–∫—É), –æ—Ç—Å–ª–µ–¥–∏—Ç—å –∑–∞–∫–∞–∑—ã –∏ —Å–≤—è–∑–∞—Ç—å—Å—è —Å –º–µ–Ω–µ–¥–∂–µ—Ä–æ–º.

---

## üß∞ –°—Ç–µ–∫ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π

| –ö–∞—Ç–µ–≥–æ—Ä–∏—è       | –ò—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏ |
|----------------|-------------------------|
| **–Ø–∑—ã–∫**        | Python 3.10+            |
| **–§—Ä–µ–π–º–≤–æ—Ä–∫**   | Aiogram 3.x             |
| **–ë–î**          | SQLite / PostgreSQL (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) |
| **ORM**         | SQLAlchemy (–∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π) |
| **–ú–∏–≥—Ä–∞—Ü–∏–∏ –ë–î** | Alembic (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)   |
| **–°–æ—Å—Ç–æ—è–Ω–∏—è**   | FSM (Finite State Machine) |
| **HTTP-–∑–∞–ø—Ä–æ—Å—ã**| AIOHTTP / Requests (–ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏) |
| **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ** | logging                 |
| **–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è**| `.env` —Ñ–∞–π–ª—ã / `config.py` |
| **–®–∞–±–ª–æ–Ω—ã**     | HTML + —ç–º–æ–¥–∑–∏           |

---

## üìã –û–ø–∏—Å–∞–Ω–∏–µ

–≠—Ç–æ—Ç Telegram-–±–æ—Ç —Ä–∞–∑—Ä–∞–±–æ—Ç–∞–Ω –Ω–∞ Python —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —Ñ—Ä–µ–π–º–≤–æ—Ä–∫–∞ **Aiogram 3.x**, —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–π —Ä–∞–±–æ—Ç—ã —á–µ—Ä–µ–∑ **SQLAlchemy ORM** –∏ **SQLite** –≤ –∫–∞—á–µ—Å—Ç–≤–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö. –ë–æ—Ç –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç —Å–ª–µ–¥—É—é—â–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏:
- –†–∞—Å—á—ë—Ç —Å—Ç–æ–∏–º–æ—Å—Ç–∏ —Ç–æ–≤–∞—Ä–∞ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º.
- –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è –∑–∞–∫–∞–∑–æ–≤.
- –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è, –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∏ —É–¥–∞–ª–µ–Ω–∏—è –∑–∞–∫–∞–∑–æ–≤.
- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–ø–∏—Å–∫–æ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π.
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –∏–Ω–ª–∞–π–Ω-–∫–ª–∞–≤–∏–∞—Ç—É—Ä –∏ FSM-–º–∞—à–∏–Ω—ã —Å–æ—Å—Ç–æ—è–Ω–∏–π.

---

## üß† –ë—ç–∫–µ–Ω–¥-–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### 1. **–§—Ä–µ–π–º–≤–æ—Ä–∫: Aiogram 3.x**
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –Ω–æ–≤–µ–π—à–∞—è –≤–µ—Ä—Å–∏—è Aiogram, –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—â–∞—è –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–µ —Ö—ç–Ω–¥–ª–µ—Ä—ã, middleware –∏ FSM.
- –•—ç–Ω–¥–ª–µ—Ä—ã —Ä–∞–∑–¥–µ–ª–µ–Ω—ã –ø–æ –º–æ–¥—É–ª—è–º (`handlers.py`).
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –∫–æ–º–∞–Ω–¥ –∏ callback-–∑–∞–ø—Ä–æ—Å–æ–≤ —á–µ—Ä–µ–∑ `CallbackQueryHandler`.

### 2. **–°–æ—Å—Ç–æ—è–Ω–∏—è: FSM (Finite State Machine)**
- –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å–æ—Å—Ç–æ—è–Ω–∏–π:
  - `OrderAdd`: –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –∑–∞–∫–∞–∑–∞.
  - `OrderUpdate`: –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ –∑–∞–∫–∞–∑–∞.
  - `OrderDelete`: –£–¥–∞–ª–µ–Ω–∏–µ –∑–∞–∫–∞–∑–∞.
  - `OrderCheck`: –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ –∑–∞–∫–∞–∑–∞.
  - `ItemsCheck`: –í—ã–±–æ—Ä –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ —Ç–æ–≤–∞—Ä–∞ –∏ —Ä–∞—Å—á—ë—Ç —Ü–µ–Ω—ã.

### 3. **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö: SQLite + SQLAlchemy ORM**
- –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–µ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ —Å –ë–î —á–µ—Ä–µ–∑ `asyncio`, `create_async_engine` –∏ `async_sessionmaker`.
- –ú–æ–¥–µ–ª–∏:
  - `User`: –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è—Ö (ID, –∏–º—è, username –∏ —Ç.–ø.).
  - `Order`: –°–æ—Å—Ç–æ—è–Ω–∏–µ –∏ ID –∑–∞–∫–∞–∑–∞.
- CRUD-–æ–ø–µ—Ä–∞—Ü–∏–∏ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã —á–µ—Ä–µ–∑ ORM-—Ñ—É–Ω–∫—Ü–∏–∏:
  - `orm_add_order`, `orm_get_orders`, `orm_update_order`, `orm_delete_order`
  - `orm_add_user`, `orm_get_users`

#### –ü—Ä–∏–º–µ—Ä –∑–∞–ø—Ä–æ—Å–∞:
```python
async def orm_get_order(session: AsyncSession, uniqid: int):
    query = select(Order).where(Order.order_id == uniqid)
    result = await session.execute(query)
    return result.scalar()
```

### 4. **Middleware**
- –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–∞—è middleware `DataBaseSession`, –∫–æ—Ç–æ—Ä–∞—è –ø–µ—Ä–µ–¥–∞–µ—Ç —ç–∫–∑–µ–º–ø–ª—è—Ä `AsyncSession` –≤ –∫–∞–∂–¥—ã–π handler:
```python
class DataBaseSession(BaseMiddleware):
    def __init__(self, session_pool: async_sessionmaker):
        self.session_pool = session_pool

    async def __call__(
        self,
        handler: Callable[[TelegramObject, Dict[str, Any]], Awaitable[Any]],
        event: TelegramObject,
        data: Dict[str, Any],
    ) -> Any:
        async with self.session_pool() as session:
            data['session'] = session
            return await handler(event, data)
```

### 5. **–ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å**
- –ß–µ—Ä–µ–∑ —Å–µ–∫—Ä–µ—Ç–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã –º–æ–∂–Ω–æ —É–ø—Ä–∞–≤–ª—è—Ç—å –∑–∞–∫–∞–∑–∞–º–∏:
  - `/add-Smkd` ‚Äî –¥–æ–±–∞–≤–∏—Ç—å –∑–∞–∫–∞–∑
  - `/update-SmLg` ‚Äî –æ–±–Ω–æ–≤–∏—Ç—å –∑–∞–∫–∞–∑
  - `/delete-Smkd` ‚Äî —É–¥–∞–ª–∏—Ç—å –∑–∞–∫–∞–∑
  - `/list-orders-Smkv` ‚Äî —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –∑–∞–∫–∞–∑–æ–≤
  - `/list-users-Smkd` ‚Äî —Å–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

---

## üõí –ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä —Ü–µ–Ω

### –õ–æ–≥–∏–∫–∞ —Ä–∞—Å—á—ë—Ç–∞:
- –î–ª—è –∫–∞–∂–¥–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –∑–∞–¥–∞–Ω —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π markup (–Ω–∞—Ü–µ–Ω–∫–∞).
- –¶–µ–Ω–∞ —Ç–æ–≤–∞—Ä–∞ –≤ —é–∞–Ω—è—Ö —É–º–Ω–æ–∂–∞–µ—Ç—Å—è –Ω–∞ –∫—É—Ä—Å —é–∞–Ω—è (`rate1 = 14.69`) –∏ —Å–∫–ª–∞–¥—ã–≤–∞–µ—Ç—Å—è —Å –Ω–∞—Ü–µ–Ω–∫–æ–π.

–ü—Ä–∏–º–µ—Ä:
```python
await message.answer(text=emoji.emojize(f'\U0001F48E<strong> –ö –æ–ø–ª–∞—Ç–µ –±—É–¥–µ—Ç: {round(float(data_calc["quantity"])*rate1+markup)} —Ä—É–±–ª–µ–π'))
```

### –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏:
- –ö—Ä–æ—Å—Å–æ–≤–∫–∏, –±–æ—Ç–∏–Ω–∫–∏, –∫—É—Ä—Ç–∫–∏, —Ö—É–¥–∏, –∞–∫—Å–µ—Å—Å—É–∞—Ä—ã –∏ –¥—Ä.
- –ù–∞—Ü–µ–Ω–∫–∏ —Ä–∞–∑–ª–∏—á–∞—é—Ç—Å—è –ø–æ —Ç–∏–ø–∞–º —Ç–æ–≤–∞—Ä–æ–≤.

---

## üß© –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
crazy-poizon-bot/
‚îú‚îÄ‚îÄ app/
‚îÇ   ‚îú‚îÄ‚îÄ database/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ models.py      # –ú–æ–¥–µ–ª–∏ SQLAlchemy
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ orm_query.py   # ORM-–∑–∞–ø—Ä–æ—Å—ã
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ requests.py    # –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
‚îÇ   ‚îú‚îÄ‚îÄ handlers.py        # –û—Å–Ω–æ–≤–Ω—ã–µ —Ö—ç–Ω–¥–ª–µ—Ä—ã –±–æ—Ç–∞
‚îÇ   ‚îî‚îÄ‚îÄ keyboard.py        # Inline-–∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã
‚îú‚îÄ‚îÄ middlewares/
‚îÇ   ‚îî‚îÄ‚îÄ db.py              # Middleware –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –ë–î
‚îú‚îÄ‚îÄ main.py                # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞
‚îú‚îÄ‚îÄ requirements.txt       # –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
‚îî‚îÄ‚îÄ config.py              # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è (—Ç–æ–∫–µ–Ω, URL –ë–î)
```

---

## ‚öôÔ∏è –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –∑–∞–ø—É—Å–∫

### 1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:
```bash
pip install -r requirements.txt
```

### 2. –°–æ–∑–¥–∞–π—Ç–µ `.env` –∏–ª–∏ –∏–∑–º–µ–Ω–∏—Ç–µ `config.py`:
```python
TOKEN = 'YOUR_TELEGRAM_BOT_TOKEN'
SQLALCHEMY_URL = 'sqlite+aiosqlite:///./db.sqlite3'
```

### 3. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –±–æ—Ç–∞:
```bash
python main.py
```



## üìå –õ–∏—Ü–µ–Ω–∑–∏—è

MIT License ‚Äî —Å–º. [LICENSE](LICENSE)

---
